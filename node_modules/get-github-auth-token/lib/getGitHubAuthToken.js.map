{"version":3,"sources":["../src/getGitHubAuthToken.ts"],"sourcesContent":["import * as cp from \"node:child_process\";\nimport * as util from \"node:util\";\n\nimport { GitHubAuthToken } from \"./types.js\";\n\nexport async function getGitHubAuthToken(): Promise<GitHubAuthToken> {\n\tif (process.env.GH_TOKEN) {\n\t\treturn { succeeded: true, token: process.env.GH_TOKEN };\n\t}\n\n\tconst exec = util.promisify(cp.exec);\n\tconst token = await exec(\"gh auth token\").catch(\n\t\t(): Record<string, string | undefined> => ({}),\n\t);\n\n\tif (token.stdout) {\n\t\treturn { succeeded: true, token: token.stdout };\n\t}\n\n\tconst help = await exec(\"gh\").catch((error: unknown) => ({\n\t\tstderr: error as string,\n\t}));\n\n\treturn {\n\t\terror:\n\t\t\t(help.stderr && `Could not run \\`gh\\`: ${help.stderr}`) ||\n\t\t\ttoken.stderr ||\n\t\t\tundefined,\n\t\tsucceeded: false,\n\t};\n}\n"],"mappings":"AAAA,YAAY,QAAQ;AACpB,YAAY,UAAU;AAItB,eAAsB,qBAA+C;AACpE,MAAI,QAAQ,IAAI,UAAU;AACzB,WAAO,EAAE,WAAW,MAAM,OAAO,QAAQ,IAAI,SAAS;AAAA,EACvD;AAEA,QAAM,OAAO,KAAK,UAAU,GAAG,IAAI;AACnC,QAAM,QAAQ,MAAM,KAAK,eAAe,EAAE;AAAA,IACzC,OAA2C,CAAC;AAAA,EAC7C;AAEA,MAAI,MAAM,QAAQ;AACjB,WAAO,EAAE,WAAW,MAAM,OAAO,MAAM,OAAO;AAAA,EAC/C;AAEA,QAAM,OAAO,MAAM,KAAK,IAAI,EAAE,MAAM,CAAC,WAAoB;AAAA,IACxD,QAAQ;AAAA,EACT,EAAE;AAEF,SAAO;AAAA,IACN,OACE,KAAK,UAAU,yBAAyB,KAAK,MAAM,MACpD,MAAM,UACN;AAAA,IACD,WAAW;AAAA,EACZ;AACD;","names":[]}